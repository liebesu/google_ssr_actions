# ğŸ” è®¤è¯ç³»ç»Ÿé…ç½®æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨é€šè¿‡ GitHub Actions Secrets é…ç½®é¡µé¢è®¤è¯ç³»ç»Ÿã€‚

## ğŸ“‹ é…ç½®ä¿¡æ¯

**å½“å‰é…ç½®**ï¼š
- **ç”¨æˆ·å**ï¼š`liebesu`
- **å¯†ç **ï¼š`Liebesu!@#`
- **å¯†ç SHA-256å“ˆå¸Œ**ï¼š`0d605622a936837919436b104b6f15fabeb1f0dea561a631abf8873858f0526a`

## ğŸš€ é…ç½®æ­¥éª¤

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Repository Variablesï¼ˆæ¨èï¼‰

è¿™ç§æ–¹å¼å°†è®¤è¯ä¿¡æ¯å­˜å‚¨ä¸º GitHub Variablesï¼Œé€‚åˆä¸å¤ªæ•æ„Ÿçš„é…ç½®ã€‚

1. **è¿›å…¥ä»“åº“è®¾ç½®**
   - æ‰“å¼€æ‚¨çš„ GitHub ä»“åº“
   - ç‚¹å‡» `Settings` (è®¾ç½®)

2. **é…ç½® Variables**
   - åœ¨å·¦ä¾§èœå•æ‰¾åˆ° `Secrets and variables` â†’ `Actions`
   - é€‰æ‹© `Variables` æ ‡ç­¾é¡µ
   - ç‚¹å‡» `New repository variable`

3. **æ·»åŠ è®¤è¯å˜é‡**

   **å˜é‡ 1 - ç”¨æˆ·å**ï¼š
   ```
   Name: AUTH_USER
   Value: liebesu
   ```
   ç‚¹å‡» `Add variable`

   **å˜é‡ 2 - å¯†ç å“ˆå¸Œ**ï¼š
   ```
   Name: AUTH_SHA256
   Value: 0d605622a936837919436b104b6f15fabeb1f0dea561a631abf8873858f0526a
   ```
   ç‚¹å‡» `Add variable`

### æ–¹å¼äºŒï¼šä½¿ç”¨ Repository Secretsï¼ˆæ›´å®‰å…¨ï¼‰

è¿™ç§æ–¹å¼å°†è®¤è¯ä¿¡æ¯å­˜å‚¨ä¸º GitHub Secretsï¼Œå®‰å…¨æ€§æ›´é«˜ï¼Œé…ç½®åæ— æ³•å†æŸ¥çœ‹ã€‚

1. **è¿›å…¥ä»“åº“è®¾ç½®**
   - æ‰“å¼€æ‚¨çš„ GitHub ä»“åº“
   - ç‚¹å‡» `Settings` (è®¾ç½®)

2. **é…ç½® Secrets**
   - åœ¨å·¦ä¾§èœå•æ‰¾åˆ° `Secrets and variables` â†’ `Actions`
   - é€‰æ‹© `Secrets` æ ‡ç­¾é¡µ
   - ç‚¹å‡» `New repository secret`

3. **æ·»åŠ è®¤è¯å¯†é’¥**

   **å¯†é’¥ 1 - ç”¨æˆ·å**ï¼š
   ```
   Name: AUTH_USER
   Secret: liebesu
   ```
   ç‚¹å‡» `Add secret`

   **å¯†é’¥ 2 - å¯†ç å“ˆå¸Œ**ï¼š
   ```
   Name: AUTH_SHA256
   Secret: 0d605622a936837919436b104b6f15fabeb1f0dea561a631abf8873858f0526a
   ```
   ç‚¹å‡» `Add secret`

## âœ… éªŒè¯é…ç½®

é…ç½®å®Œæˆåï¼Œä¸‹æ¬¡ GitHub Actions è¿è¡Œæ—¶å°†è‡ªåŠ¨åº”ç”¨æ–°çš„è®¤è¯é…ç½®ã€‚

### æ‰‹åŠ¨è§¦å‘æ„å»º

1. è¿›å…¥ `Actions` æ ‡ç­¾é¡µ
2. é€‰æ‹© `build-and-publish-subscriptions` workflow
3. ç‚¹å‡» `Run workflow` â†’ `Run workflow`
4. ç­‰å¾…æ„å»ºå®Œæˆï¼ˆçº¦3-5åˆ†é’Ÿï¼‰

### æµ‹è¯•ç™»å½•

1. æ‰“å¼€æ‚¨çš„ GitHub Pages åœ°å€ï¼š`https://<username>.github.io/<repo>`
2. åº”è¯¥ä¼šçœ‹åˆ°ç™»å½•æ¡†
3. è¾“å…¥ï¼š
   - ç”¨æˆ·åï¼š`liebesu`
   - å¯†ç ï¼š`Liebesu!@#`
4. ç‚¹å‡»"è¿›å…¥"ï¼Œåº”è¯¥èƒ½æˆåŠŸç™»å½•å¹¶çœ‹åˆ°å†…å®¹

## ğŸ”„ ä¿®æ”¹å¯†ç 

å¦‚æœéœ€è¦ä¿®æ”¹å¯†ç ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### 1. è®¡ç®—æ–°å¯†ç çš„SHA-256å“ˆå¸Œ

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ï¼š

**æ–¹æ³• A - ä½¿ç”¨ Python**ï¼š
```bash
python3 -c "import hashlib; pwd='ä½ çš„æ–°å¯†ç '; print('SHA-256:', hashlib.sha256(pwd.encode('utf-8')).hexdigest())"
```

**æ–¹æ³• B - ä½¿ç”¨åœ¨çº¿å·¥å…·**ï¼š
è®¿é—® https://emn178.github.io/online-tools/sha256.html
è¾“å…¥æ–°å¯†ç ï¼Œå¤åˆ¶ç”Ÿæˆçš„å“ˆå¸Œå€¼

### 2. æ›´æ–° GitHub Secrets/Variables

å°†æ­¥éª¤1è·å¾—çš„å“ˆå¸Œå€¼æ›´æ–°åˆ° `AUTH_SHA256` secret/variable ä¸­ã€‚

### 3. é‡æ–°è¿è¡Œ GitHub Actions

æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡æ„å»ºï¼Œæ–°çš„è®¤è¯é…ç½®å°†ç”Ÿæ•ˆã€‚

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

å½“å‰è®¤è¯ç³»ç»Ÿå…·æœ‰ä»¥ä¸‹å®‰å…¨ç‰¹æ€§ï¼š

1. **å¯†ç ä¸æ˜æ–‡å­˜å‚¨**ï¼šå¯†ç ä»¥ SHA-256 å“ˆå¸Œå½¢å¼å­˜å‚¨
2. **å†…å®¹é»˜è®¤éšè—**ï¼šæœªè®¤è¯æ—¶ï¼Œé¡µé¢ä¸»ä½“å†…å®¹å®Œå…¨éšè—ï¼ˆ`display:none`ï¼‰
3. **é˜²æ­¢å¼€å‘è€…å·¥å…·ç»•è¿‡**ï¼šå³ä½¿åˆ é™¤ç™»å½•æ¡†ï¼Œå†…å®¹ä»ç„¶éšè—
4. **LocalStorage ç¼“å­˜**ï¼šè®¤è¯æˆåŠŸåä¿å­˜åˆ°æœ¬åœ°ï¼Œé¿å…é‡å¤ç™»å½•
5. **åŒå› ç´ éªŒè¯**ï¼šåŒæ—¶éªŒè¯ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œ

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **è®¢é˜…æ–‡ä»¶æ— éœ€è®¤è¯**ï¼š`sub/` ç›®å½•ä¸‹çš„æ‰€æœ‰è®¢é˜…æ–‡ä»¶å¯ç›´æ¥è®¿é—®ï¼Œæ— éœ€ç™»å½•
2. **å¯†ç é‡ç½®**ï¼šå¦‚æœå¿˜è®°å¯†ç ï¼Œåªèƒ½é€šè¿‡ä¿®æ”¹ GitHub Secrets æ¥é‡ç½®
3. **æµè§ˆå™¨ç¼“å­˜**ï¼šå¦‚æœä¿®æ”¹äº†å¯†ç ï¼Œç”¨æˆ·éœ€è¦æ¸…é™¤æµè§ˆå™¨ LocalStorage æˆ–ä½¿ç”¨éšç§æ¨¡å¼é‡æ–°ç™»å½•
4. **å®‰å…¨æé†’**ï¼šé¡µé¢è®¤è¯åªæ˜¯åŸºç¡€é˜²æŠ¤ï¼Œæ•æ„Ÿæ•°æ®åº”ä½¿ç”¨åç«¯APIä¿æŠ¤

## ğŸ”§ å·¥ä½œæµé›†æˆ

GitHub Actions workflow å·²é…ç½®å¥½ç›¸å…³é€»è¾‘ï¼š

```yaml
# .github/workflows/build-and-publish-subscriptions.yml

- name: Generate subscriptions
  run: |
    # ... å…¶ä»–é…ç½® ...
    
    # ä¼ é€’è®¤è¯ç¯å¢ƒå˜é‡
    if [ -n "${{ vars.AUTH_USER }}" ]; then 
      export AUTH_USER="${{ vars.AUTH_USER }}"; 
    fi
    if [ -n "${{ secrets.AUTH_SHA256 }}" ]; then 
      export AUTH_SHA256="${{ secrets.AUTH_SHA256 }}"; 
    fi
    
    python aggregator_cli.py --output-dir dist --emit-index
```

## ğŸ†˜ æ•…éšœæ’é™¤

### é—®é¢˜ï¼šç™»å½•åä»ç„¶çœ‹ä¸åˆ°å†…å®¹

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
2. æ£€æŸ¥ Console æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
3. æ£€æŸ¥ Network æ ‡ç­¾é¡µï¼Œç¡®è®¤ `health.json` å’Œ `sub/url_meta.json` èƒ½æ­£å¸¸åŠ è½½
4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œ LocalStorageï¼Œé‡æ–°ç™»å½•

### é—®é¢˜ï¼šå¯†ç æ­£ç¡®ä½†æç¤ºé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ GitHub Secrets ä¸­çš„ `AUTH_SHA256` å€¼æ­£ç¡®
2. é‡æ–°è®¡ç®—å¯†ç å“ˆå¸Œå¹¶æ›´æ–°
3. æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡ GitHub Actions æ„å»º

### é—®é¢˜ï¼šé¡µé¢å®Œå…¨ç©ºç™½

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ GitHub Pages æ˜¯å¦æˆåŠŸéƒ¨ç½²
2. æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡ Actions è¿è¡Œæ—¥å¿—
3. ç¡®è®¤ `dist/index.html` æ–‡ä»¶å­˜åœ¨ä¸”éç©º

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [GitHub Actions Secrets](https://docs.github.com/en/actions/security-guides/encrypted-secrets)
- [GitHub Pages éƒ¨ç½²](https://docs.github.com/en/pages)
- [SHA-256 å“ˆå¸Œ](https://en.wikipedia.org/wiki/SHA-2)

---

**é…ç½®å®Œæˆåï¼Œæ‚¨çš„é¡µé¢å°†å—åˆ°å¯†ç ä¿æŠ¤ï¼** ğŸ‰

