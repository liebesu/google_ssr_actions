<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Google SSR Actions - è®¢é˜…èšåˆ</title>
  <link rel="stylesheet" href="styles.css" />
  <script>
    const AUTH_HASH = "1dd2557b6334b098dc895f52fe46add7880094aec59a2eece3e4c5da2fc79f86";
    const AUTH_USER = "liebesu";
    async function sha256(message) {
      const msgBuffer = new TextEncoder().encode(message);
      const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
    function showAuth() {
      const mask = document.getElementById('auth-mask');
      const userInput = document.getElementById('auth-user');
      const passInput = document.getElementById('auth-input');
      const err = document.getElementById('auth-err');
      const btn = document.getElementById('auth-btn');
      mask.style.display = 'flex';
      userInput.focus();
      async function submit() {
        const user = userInput.value.trim();
        const pwd = passInput.value || '';
        const h = await sha256(pwd);
        const userRequired = (AUTH_USER || '').trim().length > 0;
        const userOk = userRequired ? (user === (AUTH_USER||'').trim()) : true;
        if (userOk && h.toLowerCase() === AUTH_HASH.toLowerCase()) {
          console.log('ğŸ‰ è®¤è¯æˆåŠŸï¼');
          try{ 
            localStorage.setItem('gauth', h); 
            localStorage.setItem('guser', user); 
            console.log('âœ… è®¤è¯ä¿¡æ¯å·²ä¿å­˜åˆ°localStorage');
          }catch(e){
            console.error('ä¿å­˜è®¤è¯ä¿¡æ¯å¤±è´¥:', e);
          }
          mask.style.display = 'none';
          document.documentElement.style.display = '';
          console.log('âœ… é¡µé¢å·²æ˜¾ç¤ºï¼Œå¼€å§‹åŠ è½½å†…å®¹...');
          
          // æ‰‹åŠ¨è§¦å‘é¡µé¢å†…å®¹åŠ è½½
          setTimeout(() => {
            try {
              if (typeof loadMeta === 'function') loadMeta();
              if (typeof loadDailyChart === 'function') loadDailyChart();
              if (typeof loadSparklines === 'function') loadSparklines();
              if (typeof loadSerpAPIKeys === 'function') loadSerpAPIKeys();
              console.log('âœ… æ‰€æœ‰å†…å®¹åŠ è½½å‡½æ•°å·²è§¦å‘');
            } catch(e) {
              console.error('å†…å®¹åŠ è½½å‡ºé”™:', e);
            }
          }, 100);
        } else {
          console.log('âŒ è®¤è¯å¤±è´¥');
          err.textContent = 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•';
        }
      }
      btn.addEventListener('click', submit);
      passInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ submit(); }});
    }
    function gate() {
      console.log('ğŸ” è®¤è¯æ£€æŸ¥å¼€å§‹...');
      console.log('AUTH_HASH:', AUTH_HASH ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®');
      console.log('AUTH_USER:', AUTH_USER ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®');
      
      if (!AUTH_HASH || AUTH_HASH.trim() === '') { 
        console.log('âœ… æ— éœ€è®¤è¯ï¼Œç›´æ¥æ˜¾ç¤ºé¡µé¢');
        document.documentElement.style.display = ''; 
        return; 
      }
      
      try{
        const tk = localStorage.getItem('gauth');
        const gu = (localStorage.getItem('guser') || '').trim();
        const userRequired = (AUTH_USER || '').trim().length > 0;
        const passOk = !!tk && (tk.toLowerCase() === AUTH_HASH.toLowerCase());
        const userOk = userRequired ? (gu === (AUTH_USER||'').trim()) : true;
        
        console.log('å­˜å‚¨çš„è®¤è¯:', tk ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
        console.log('å¯†ç éªŒè¯:', passOk ? 'é€šè¿‡' : 'å¤±è´¥');
        console.log('ç”¨æˆ·éªŒè¯:', userOk ? 'é€šè¿‡' : 'å¤±è´¥');
        
        if (passOk && userOk) { 
          console.log('âœ… è®¤è¯æˆåŠŸï¼Œæ˜¾ç¤ºé¡µé¢');
          document.documentElement.style.display = ''; 
          
          // ç¡®ä¿å†…å®¹åŠ è½½å‡½æ•°åœ¨é¡µé¢æ˜¾ç¤ºåæ‰§è¡Œ
          setTimeout(() => {
            try {
              if (typeof loadMeta === 'function') loadMeta();
              if (typeof loadDailyChart === 'function') loadDailyChart();
              if (typeof loadSparklines === 'function') loadSparklines();
              if (typeof loadSerpAPIKeys === 'function') loadSerpAPIKeys();
              console.log('âœ… è‡ªåŠ¨åŠ è½½æ‰€æœ‰å†…å®¹å®Œæˆ');
            } catch(e) {
              console.error('è‡ªåŠ¨å†…å®¹åŠ è½½å‡ºé”™:', e);
            }
          }, 100);
          return;
        }
      }catch(e){
        console.error('è®¤è¯æ£€æŸ¥å‡ºé”™:', e);
      }
      
      console.log('âŒ è®¤è¯å¤±è´¥ï¼Œæ˜¾ç¤ºç™»å½•æ¡†');
      showAuth(); // ç›´æ¥æ˜¾ç¤ºè®¤è¯å¼¹çª—è€Œä¸æ˜¯è·³è½¬
    }
    // å¼ºåˆ¶ç¡®ä¿é¡µé¢èƒ½å¤Ÿæ˜¾ç¤º
    console.log('ğŸš€ é¡µé¢åˆå§‹åŒ–å¼€å§‹...');
    
    // å…ˆç«‹å³æ˜¾ç¤ºé¡µé¢ï¼Œç„¶åè¿›è¡Œè®¤è¯æ£€æŸ¥
    document.documentElement.style.display = '';
    
    // å»¶è¿Ÿéšè—é¡µé¢ï¼Œç»™è®¤è¯æ£€æŸ¥è¶³å¤Ÿæ—¶é—´
    setTimeout(function() {
      console.log('ğŸ” å¼€å§‹è®¤è¯æ£€æŸ¥ï¼Œæš‚æ—¶éšè—é¡µé¢...');
      document.documentElement.style.display = 'none';
      
      // ç«‹å³è¿›è¡Œè®¤è¯æ£€æŸ¥
      gate();
      
      // è¶…çŸ­æ—¶é—´fallback - ç¡®ä¿ç”¨æˆ·èƒ½çœ‹åˆ°å†…å®¹
      setTimeout(function() {
        if (document.documentElement.style.display === 'none') {
          console.log('âš ï¸ 1ç§’fallback - å¼ºåˆ¶æ˜¾ç¤ºè®¤è¯æ¡†');
          showAuth();
        }
      }, 1000);
      
      // æœ€ç»ˆfallback - æ— è®ºå¦‚ä½•éƒ½è¦æ˜¾ç¤º
      setTimeout(function() {
        if (document.documentElement.style.display === 'none') {
          console.log('ğŸš¨ æœ€ç»ˆfallback - å¼ºåˆ¶æ˜¾ç¤ºé¡µé¢');
          document.documentElement.style.display = '';
          showAuth();
        }
      }, 2000);
      
    }, 100);
    
    // å¤šé‡äº‹ä»¶ç›‘å¬ä¿éšœ
    document.addEventListener('DOMContentLoaded', function() {
      console.log('ğŸ“„ DOMåŠ è½½å®Œæˆï¼Œæ£€æŸ¥è®¤è¯çŠ¶æ€...');
      setTimeout(gate, 50);
    });
    
    window.addEventListener('load', function() {
      console.log('ğŸŒ é¡µé¢å®Œå…¨åŠ è½½ï¼Œæœ€ç»ˆæ£€æŸ¥...');
      setTimeout(function() {
        if (document.documentElement.style.display === 'none') {
          console.log('âš ï¸ é¡µé¢åŠ è½½å®Œæˆä½†ä»éšè—ï¼Œå¼ºåˆ¶æ˜¾ç¤ºè®¤è¯æ¡†');
          showAuth();
        }
      }, 100);
    });
    // æ ¹æ®æ˜¯å¦æœ‰é…é¢æ•°æ®éšè—å¡ç‰‡
    document.addEventListener('DOMContentLoaded', ()=>{
      const qleft = '472'; const qcap = '1250'; const kok='5'; const kt='5';
      const hideQuota = (!qleft || qleft==='0') && (!qcap || qcap==='0') && (!kok || kok==='0') && (!kt || kt==='0');
      if(hideQuota){
        document.querySelectorAll('.stat.quota').forEach(el=>el.style.display='none');
      }
    });
  </script>
</head>
<body>
  <div class="wrap">
    <div id="auth-mask" class="auth-mask" style="display:none">
      <div class="auth-card">
        <h3 class="auth-title">è®¿é—®è®¤è¯</h3>
        <p class="auth-sub">è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ä»¥æŸ¥çœ‹é¡µé¢å†…å®¹</p>
        <input id="auth-user" class="auth-input" type="text" placeholder="è¾“å…¥ç”¨æˆ·å" />
        <input id="auth-input" class="auth-input" type="password" placeholder="è¾“å…¥å¯†ç " />
        <button id="auth-btn" class="auth-btn">è¿›å…¥</button>
        <div id="auth-err" class="auth-err"></div>
      </div>
    </div>
    <div class="header">
      <h1>Google SSR Actions</h1>
      <small>æ„å»ºæ—¶é—´(ä¸­å›½æ—¶åŒº)ï¼š2025-09-24 19:00:00</small>
    </div>
    <div class="subtitle">æº 108/192 Â· èŠ‚ç‚¹ 1200 Â· æ–°å¢ 0 Â· ç§»é™¤ 4</div>

    <div class="stats" id="stats-cards">
      <div class="stat quota" data-hide="q"><div class="num">472</div><div>å‰©ä½™é¢åº¦</div></div>
      <div class="stat quota" data-hide="q"><div class="num">1250</div><div>æ€»é¢åº¦</div></div>
      <div class="stat quota" data-hide="q"><div class="num">5/5</div><div>å¯ç”¨å¯†é’¥/æ€»å¯†é’¥</div></div>
      <div class="stat"><div class="num">2025-09-24 22:00:00</div><div>ä¸‹æ¬¡æ›´æ–°æ—¶é—´(ä¸­å›½æ—¶åŒº)</div></div>
    </div>

    <div class="grid">
      <div class="card card-metrics">
        <h3>å…³é”®æŒ‡æ ‡ï¼ˆ7/30å¤©ï¼‰</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px">
          <div>
            <small>æ–°å¢(7å¤©)</small>
            <canvas id="spark-added-7" height="40"></canvas>
          </div>
          <div>
            <small>å¤±æ•ˆ(7å¤©)</small>
            <canvas id="spark-removed-7" height="40"></canvas>
          </div>
          <div>
            <small>å­˜æ´»(30å¤©)</small>
            <canvas id="spark-alive-30" height="40"></canvas>
          </div>
        </div>
      </div>
      <div class="card card-files">
        <h3>è®¢é˜…æ–‡ä»¶</h3>
        <ul>
          <li><a href="sub/all.txt"><code>sub/all.txt</code></a> å…¨é‡è®¢é˜… (æ–‡æœ¬æ ¼å¼)</li>
          <li><a href="sub/good.txt"><code>sub/good.txt</code></a> ä¼˜ç§€èŠ‚ç‚¹ (é«˜è´¨é‡ç­›é€‰)</li>
          <li><a href="sub/all.yaml"><code>sub/all.yaml</code></a> Clashé…ç½® (åŒ…å«å®Œæ•´èŠ‚ç‚¹ä¿¡æ¯)</li>
          <li><a href="sub/all_providers.yaml"><code>sub/all_providers.yaml</code></a> Clashé…ç½® (ä½¿ç”¨proxy-providers)</li>
        </ul>
        <p><small style="color:#94a3b8">ğŸ“Œ æ‰€æœ‰è®¢é˜…æ–‡ä»¶å’Œæ¥å£å¯ç›´æ¥è®¿é—®ï¼Œæ— éœ€é¡µé¢è®¤è¯</small></p>
      </div>

      <div class="card card-sources">
        <h3>URL æº</h3>
        <ul>
          <li><a href="sub/urls.txt"><code>urls.txt</code></a> å½“å‰å¯ç”¨æº</li>
          <li><a href="sub/all_urls.txt"><code>all_urls.txt</code></a> å®Œæ•´æºåˆ—è¡¨</li>
          <li><a href="sub/google_urls.txt"><code>google_urls.txt</code></a> Googleå‘ç°ï¼ˆ103ï¼‰</li>
          <li><a href="sub/github_urls.txt"><code>github_urls.txt</code></a> GitHubå‘ç°ï¼ˆ5ï¼‰</li>
        </ul>
      </div>

      <div class="card card-health">
        <h3>å¥åº·ä¿¡æ¯</h3>
        <ul class="health-list">
          <li>æ„å»ºæ—¶é—´(ä¸­å›½æ—¶åŒº)ï¼š<b>2025-09-24 19:00:00</b></li>
          <li>ä¸‹æ¬¡æ›´æ–°æ—¶é—´(ä¸­å›½æ—¶åŒº)ï¼š<b>2025-09-24 22:00:00</b></li>
          <li>æºï¼š<b>108/192</b> Â· æ–°å¢ <b>0</b> Â· ç§»é™¤ <b>4</b></li>
          <li>èŠ‚ç‚¹ï¼š<b>1200</b> Â· åè®® SS <b>147</b> | VMess <b>53</b> | VLESS <b>77</b> | Trojan <b>39</b> | HY2 <b>884</b></li>
          <li>æ¥æºï¼šGoogle <b>103</b> | GitHub <b>5</b></li>
        </ul>
      </div>

      <div class="card card-serpapi">
        <h3>SerpAPI å¯†é’¥çŠ¶æ€</h3>
        <div id="serpapi-status">
          <div class="serpapi-summary">
            <span class="status-item">å¯ç”¨å¯†é’¥: <b id="keys-ok">5</b>/<b id="keys-total">5</b></span>
            <span class="status-item">æ€»å‰©ä½™é¢åº¦: <b id="quota-left">472</b>/<b id="quota-cap">1250</b></span>
          </div>
          <div id="serpapi-keys-list" class="serpapi-keys-list">
            <!-- åŠ¨æ€åŠ è½½å¯†é’¥è¯¦æƒ… -->
          </div>
        </div>
      </div>

      <div class="card card-protocols">
        <h3>åè®®åˆ†å¸ƒ</h3>
        <ul>
          <li>SSï¼š147</li>
          <li>VMessï¼š53</li>
          <li>VLESSï¼š77</li>
          <li>Trojanï¼š39</li>
          <li>Hysteria2ï¼š884</li>
        </ul>
      </div>

      <div class="card card-extras">
        <h3>è¾…åŠ©è¾“å‡º</h3>
        <ul>
          <li><a href="sub/github.txt"><code>github.txt</code></a> GitHubèŠ‚ç‚¹</li>
          <li><a href="sub/proto/ss-base64.txt"><code>ss-base64.txt</code></a> SS Base64</li>
          <li><a href="health.json"><code>health.json</code></a> å¥åº·ä¿¡æ¯</li>
        </ul>
        <p><small style="color:#94a3b8">ğŸ’¡ APIæ¥å£å’ŒJSONæ•°æ®å¯é€šè¿‡ç¨‹åºç›´æ¥è°ƒç”¨</small></p>
      </div>

      <div class="card card-wide card-details">
        <h3>æºè¯¦ç»†ä¿¡æ¯</h3>
        <p><small>åŒ…å«æœºåœºåç§°ã€å®¹é‡/å‰©ä½™ã€åè®®ã€å¤åˆ¶ä¸æµ‹é€Ÿã€è¯¦æƒ…é¡µã€‚</small></p>
        <div id="url-meta"><small>åŠ è½½ä¸­...</small></div>
        <div class="chart">
          <h4 style="margin:0 0 8px 0">æ¯æ—¥æ–°å¢å¯ç”¨URL</h4>
          <canvas id="dailyChart" height="120"></canvas>
        </div>
        <script>
          function copyText(text){
            navigator.clipboard.writeText(text).then(()=>{
              alert('å·²å¤åˆ¶è®¢é˜…é“¾æ¥');
            }).catch(()=>{});
          }
          async function testSpeed(url){
            const t0 = performance.now();
            try{ await fetch(url, {method:'HEAD', mode:'no-cors'}); }catch(e){}
            const t1 = performance.now();
            return Math.round(t1 - t0);
          }
          async function runBatchSpeed(urls, concurrency){
            const results = new Array(urls.length).fill(null);
            let idx = 0;
            async function worker(){
              while(idx < urls.length){
                const i = idx++;
                const u = urls[i];
                const ms = await testSpeed(u);
                results[i] = ms;
                const cell = document.querySelector(`[data-url-id="${i}"]`);
                if(cell){
                  cell.textContent = ms;
                  cell.style.color = ms<=300?'#10b981':(ms<=800?'#60a5fa':'#f59e0b');
                }
              }
            }
            const workers = Array.from({length: Math.min(concurrency, urls.length)}, ()=>worker());
            await Promise.all(workers.map(w=>w()));
            return results;
          }
          async function loadMeta() {
            try {
              const res = await fetch('sub/url_meta.json', { cache: 'no-cache' });
              if (!res.ok) throw new Error('fetch failed');
              let data = await res.json();
              // åªå±•ç¤ºå¯ç”¨æº
              data = (Array.isArray(data) ? data : []).filter(x=>x && x.available);
              // æŒ‰è´¨é‡åˆ†å€’åºæ’åº
              data.sort((a,b)=> (b.quality_score||0) - (a.quality_score||0));
              const rows = data.map(function(item, i){
                const q = (item.quality_score ?? 0);
                const qColor = q>=80?'#10b981':(q>=60?'#60a5fa':'#f59e0b');
                const src = (item.source||'').toLowerCase();
                const pillColor = src==='github'?'#111827': '#0b1220';
                const pillText = src==='github'?'GitHub':'Google';
                return '<tr>' +
                  '<td><div style="display:flex;gap:8px;align-items:center">' +
                    '<a href="' + (item.url||'#') + '" target="_blank">æº</a>' +
                    '<small style="color:#94a3b8">' + (item.provider||item.host||'') + '</small>' +
                  '</div></td>' +
                  '<td>' + (item.available ? 'âœ…' : 'âŒ') + '</td>' +
                  '<td>' + (item.nodes_total ?? 0) + '</td>' +
                  '<td>' + (item.protocols ?? '') + '</td>' +
                  '<td>' + ((item.traffic?.remaining ?? '-') + ' / ' + (item.traffic?.total ?? '-') + ' ' + (item.traffic?.unit ?? '')) + '</td>' +
                  '<td data-url-id="' + i + '">' + (item.response_ms ?? '-') + '</td>' +
                  '<td><b style="color:' + qColor + '">' + q + '</b></td>' +
                  '<td><span class="pill" style="background:' + pillColor + '">' + pillText + '</span></td>' +
                  '<td>' + (item.first_seen || '-') + '</td>' +
                  '<td>' +
                    '<button onclick="copyText(\'' + (item.url||'') + '\')" style="padding:4px 8px;border-radius:8px;border:1px solid #1f2937;background:#0b1220;color:#e5e7eb">å¤åˆ¶</button>' +
                    '<button class="btn-speed" data-url="' + (item.url||'') + '" style="margin-left:6px;padding:4px 8px;border-radius:8px;border:1px solid #1f2937;background:#0b1220;color:#e5e7eb">æµ‹é€Ÿ</button>' +
                    (item.detail_page ? '<a href="' + item.detail_page + '" style="margin-left:8px">è¯¦æƒ…</a>' : '') +
                  '</td>' +
                '</tr>';
              }).join('');
              const html = '<table>' +
                '<thead><tr>' +
                '<th style="text-align:left">URL/æœºåœº</th>' +
                '<th>å¯ç”¨</th>' +
                '<th>èŠ‚ç‚¹æ•°</th>' +
                '<th>åè®®</th>' +
                '<th>æµé‡(å‰©ä½™/æ€»é‡)</th>' +
                '<th>è€—æ—¶(ms)</th>' +
                '<th>è´¨é‡</th>' +
                '<th>æ¥æº</th>' +
                '<th>é‡‡é›†</th>' +
                '<th>æ“ä½œ</th>' +
                '</tr></thead>' +
                '<tbody>' + rows + '</tbody>' +
                '</table>';
              document.getElementById('url-meta').innerHTML = html;
              // ç»‘å®šå•å‡»æµ‹é€Ÿ
              document.querySelectorAll('.btn-speed').forEach(btn=>{
                btn.addEventListener('click', async (e)=>{
                  const u = e.currentTarget.getAttribute('data-url');
                  const ms = await testSpeed(u);
                  e.currentTarget.closest('tr').querySelector('[data-url-id]').textContent = ms;
                });
              });
              // æ‰¹é‡æµ‹é€Ÿï¼ˆé™å¹¶å‘ 6ï¼‰
              const urls = data.map(x=>x.url);
              runBatchSpeed(urls, 6);
            } catch(e) {
              document.getElementById('url-meta').innerHTML = '<small>æœªè·å–åˆ°æºè¯¦æƒ…</small>';
            }
          }
          async function loadDailyChart() {
            try {
              const r = await fetch('sub/stats_daily.json', { cache:'no-cache' });
              if (!r.ok) return;
              const d = await r.json();
              const labels = d.map(x=>x.date);
              const google = d.map(x=>x.google_added||0);
              const github = d.map(x=>x.github_added||0);
              const added = d.map(x=>x.new_total||0);
              const removed = d.map(x=>x.removed_total||0);
              const canvas = document.getElementById('dailyChart');
              const ctx = canvas.getContext('2d');
              // æç®€ç»˜åˆ¶
              const max = Math.max(1, ...google, ...github, ...added, ...removed);
              const W = canvas.width = canvas.clientWidth;
              const H = canvas.height;
              function plot(series, color, yoff) {
                ctx.strokeStyle=color; ctx.lineWidth=2; ctx.beginPath();
                series.forEach((v,i)=>{
                  const x = (W-20) * (i/(series.length-1)) + 10;
                  const y = H-10 - (H-20) * (v/max);
                  if (i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
                }); ctx.stroke();
              }
              ctx.clearRect(0,0,W,H); ctx.fillStyle='#0b1220'; ctx.fillRect(0,0,W,H);
              plot(google,'#60a5fa'); plot(github,'#10b981'); plot(added,'#a78bfa'); plot(removed,'#f87171');
            } catch(e) {}
          }
          function drawSparkline(canvasId, series, color){
            const c = document.getElementById(canvasId); if(!c) return; const ctx=c.getContext('2d');
            const W = c.width = c.clientWidth || 160; const H = c.height; const max = Math.max(1, ...series);
            ctx.clearRect(0,0,W,H); ctx.strokeStyle=color; ctx.lineWidth=2; ctx.beginPath();
            series.forEach((v,i)=>{ const x=(W-6)*(i/(series.length-1))+3; const y=H-3 - (H-6)*(v/max); if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y); });
            ctx.stroke();
          }
          async function loadSparklines(){
            try{
              const r = await fetch('sub/stats_daily.json', { cache:'no-cache' }); if(!r.ok) return;
              const d = await r.json();
              const last7 = d.slice(-7);
              const last30 = d.slice(-30);
              drawSparkline('spark-added-7', last7.map(x=>x.new_total||0), '#60a5fa');
              drawSparkline('spark-removed-7', last7.map(x=>x.removed_total||0), '#f87171');
              drawSparkline('spark-alive-30', last30.map(x=>x.alive_total||0), '#10b981');
            }catch(e){}
          }

          // åŠ è½½ SerpAPI å¯†é’¥è¯¦æƒ…
          async function loadSerpAPIKeys() {
            try {
              const r = await fetch('health.json', { cache:'no-cache' });
              if(!r.ok) return;
              const health = await r.json();
              const keys = health.serpapi_keys_detail || [];
              const container = document.getElementById('serpapi-keys-list');
              if(!container) return;
              
              if(keys.length === 0) {
                container.innerHTML = '<div class="serpapi-key-item error">æš‚æ— å¯†é’¥ä¿¡æ¯</div>';
                return;
              }
              
              container.innerHTML = keys.map(key => {
                if(key.error) {
                  const keyInfo = key.key_masked ? `(${key.key_masked})` : '';
                  return `<div class="serpapi-key-item error">
                    <div class="key-header">
                      <span class="key-index">Key ${key.index} ${keyInfo}</span>
                      <span class="key-status">é”™è¯¯</span>
                    </div>
                    <div class="key-details">
                      <div style="color:#ef4444">${key.error}</div>
                      ${key.status === 'key_valid_unchecked' ? '<div style="color:#10b981;margin-top:4px">âœ“ å¯†é’¥æ ¼å¼æœ‰æ•ˆï¼Œä½†æ— æ³•æ£€æŸ¥é…é¢</div>' : ''}
                      ${key.status === 'key_invalid' ? '<div style="color:#ef4444;margin-top:4px">âœ— å¯†é’¥æ ¼å¼æ— æ•ˆ</div>' : ''}
                    </div>
                  </div>`;
                }
                const used = key.used_searches || 0;
                const total = key.searches_per_month || 0;
                const left = key.total_searches_left || 0;
                const usagePercent = total > 0 ? Math.round((used / total) * 100) : 0;
                const statusClass = left <= 0 ? 'exhausted' : (usagePercent > 80 ? 'warning' : 'ok');
                const resetDate = key.reset_date ? new Date(key.reset_date).toLocaleDateString('zh-CN') : 'æœªçŸ¥';
                const keyInfo = key.key_masked ? `(${key.key_masked})` : '';
                
                return `
                  <div class="serpapi-key-item ${statusClass}">
                    <div class="key-header">
                      <span class="key-index">Key ${key.index} ${keyInfo}</span>
                      <span class="key-status">${left <= 0 ? 'å·²ç”¨å°½' : (usagePercent > 80 ? 'å³å°†ç”¨å°½' : 'æ­£å¸¸')}</span>
                    </div>
                    <div class="key-details">
                      <div class="quota-bar">
                        <div class="quota-fill" style="width: ${usagePercent}%"></div>
                      </div>
                      <div class="quota-text">å·²ç”¨ ${used}/${total} (${usagePercent}%) Â· å‰©ä½™ ${left}</div>
                      <div class="reset-info">é‡ç½®æ—¶é—´: ${resetDate}</div>
                    </div>
                  </div>
                `;
              }).join('');
            } catch(e) { 
              console.warn('SerpAPI keys load failed:', e);
              const container = document.getElementById('serpapi-keys-list');
              if(container) container.innerHTML = '<div class="serpapi-key-item error">åŠ è½½å¤±è´¥</div>';
            }
          }
          loadMeta(); loadDailyChart(); loadSparklines(); loadSerpAPIKeys();
        </script>
      </div>
    </div>

    <p><small>ä»…å±•ç¤ºå¯ç”¨æºï¼ˆè‡ªåŠ¨è¿‡æ»¤å¤±æ•ˆ/è¶…é¢/é™é€Ÿæ¥æºï¼‰ã€‚ æ„å»º(UTC)ï¼š2025-09-24 11:00:00 Â· ä¸‹æ¬¡(UTC)ï¼š2025-09-24 14:00:00</small></p>
  </div>
</body>
</html>

